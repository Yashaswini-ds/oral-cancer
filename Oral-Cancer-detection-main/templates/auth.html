{% extends "base.html" %}

{% block content %}
<div class="auth-container fade-in-up">
    <div class="auth-box">
        <div class="auth-toggle d-flex justify-content-center mb-4 p-1 bg-light rounded-pill">
            <button id="login-btn" class="btn btn-sm rounded-pill flex-fill fw-bold active"
                onclick="showLogin()">Login</button>
            <button id="signup-btn" class="btn btn-sm rounded-pill flex-fill fw-bold text-muted"
                onclick="showSignup()">Sign Up</button>
        </div>

        <!-- Login Form -->
        <form id="login-form" action="{{ url_for('auth') }}" method="POST" class="auth-form">
            <input type="hidden" name="action" value="login">
            <h2 class="text-center mb-4 fw-bold" style="color: var(--primary-color);">Welcome Back</h2>

            <div class="mb-3">
                <div class="input-group">
                    <span class="input-group-text bg-light border-end-0"><i
                            class="fas fa-envelope text-muted"></i></span>
                    <input type="email" name="email" class="form-control bg-light border-start-0 ps-0" required
                        placeholder="Email Address">
                </div>
            </div>
            <div class="mb-4">
                <div class="input-group">
                    <span class="input-group-text bg-light border-end-0"><i class="fas fa-lock text-muted"></i></span>
                    <input type="password" name="password" class="form-control bg-light border-start-0 ps-0" required
                        placeholder="Password">
                </div>
            </div>

            <button type="submit"
                class="btn btn-primary w-100 py-3 rounded-pill fw-bold shadow-sm pulse-effect">Login</button>
            <div class="text-center mt-3">
                <a href="{{ url_for('register_doctor') }}" class="text-decoration-none small text-muted">Are you a
                    doctor? Register here</a>
            </div>
        </form>

        <!-- Signup Form -->
        <form id="signup-form" action="{{ url_for('auth') }}" method="POST" class="auth-form" style="display: none;"
            onsubmit="return validateSignup()">
            <input type="hidden" name="action" value="signup">
            <h2 class="text-center mb-4 fw-bold" style="color: var(--primary-color);">Create Account</h2>

            <div class="mb-3">
                <div class="input-group">
                    <span class="input-group-text bg-light border-end-0"><i class="fas fa-user text-muted"></i></span>
                    <input type="text" name="username" class="form-control bg-light border-start-0 ps-0" required
                        placeholder="Full Name">
                </div>
            </div>
            <div class="mb-3">
                <div class="input-group">
                    <span class="input-group-text bg-light border-end-0"><i
                            class="fas fa-envelope text-muted"></i></span>
                    <input type="email" name="email" class="form-control bg-light border-start-0 ps-0" required
                        placeholder="Email Address">
                </div>
            </div>
            <div class="mb-4">
                <div class="input-group">
                    <span class="input-group-text bg-light border-end-0"><i class="fas fa-lock text-muted"></i></span>
                    <input type="password" name="password" id="signup-password"
                        class="form-control bg-light border-start-0 ps-0" required placeholder="Password (min 8 chars)">
                </div>
                <div id="password-error" class="text-danger small mt-1" style="display:none;">Password must be at least
                    8 characters.</div>
            </div>

            <button type="submit" class="btn btn-primary w-100 py-3 rounded-pill fw-bold shadow-sm pulse-effect">Sign
                Up</button>
        </form>
    </div>
</div>

<script>
    function showLogin() {
        document.getElementById('login-form').style.display = 'block';
        document.getElementById('signup-form').style.display = 'none';

        const loginBtn = document.getElementById('login-btn');
        const signupBtn = document.getElementById('signup-btn');

        loginBtn.classList.add('active', 'btn-primary');
        loginBtn.classList.remove('text-muted');

        signupBtn.classList.remove('active', 'btn-primary');
        signupBtn.classList.add('text-muted');
    }

    function showSignup() {
        document.getElementById('login-form').style.display = 'none';
        document.getElementById('signup-form').style.display = 'block';

        const loginBtn = document.getElementById('login-btn');
        const signupBtn = document.getElementById('signup-btn');

        signupBtn.classList.add('active', 'btn-primary');
        signupBtn.classList.remove('text-muted');

        loginBtn.classList.remove('active', 'btn-primary');
        loginBtn.classList.add('text-muted');
    }

    // Initialize styles
    document.addEventListener('DOMContentLoaded', function () {
        const loginBtn = document.getElementById('login-btn');
        loginBtn.classList.add('btn-primary');
    });

    function validateSignup() {
        const password = document.getElementById('signup-password').value;
        const errorDiv = document.getElementById('password-error');
        if (password.length < 8) {
            errorDiv.style.display = 'block';
            return false;
        }
        errorDiv.style.display = 'none';
        return true;
    }
</script>
{% endblock %}