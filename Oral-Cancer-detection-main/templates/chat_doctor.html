{% extends "base.html" %}
{% block title %}Chat (Doctor){% endblock %}
{% block content %}
<h3>Chat (Doctor)</h3>
<div class="mb-2 text-muted small">Record: {{ record.timestamp }}</div>

<div class="card shadow-sm mb-3">
  <div class="card-body" style="max-height: 360px; overflow:auto">
    {% if record.doctor_replies_list %}
    {% for m in record.doctor_replies_list %}
    <div class="mb-2"><span class="badge bg-primary me-2">Doctor</span>{{ m.time }} — {{ m.message }}</div>
    {% endfor %}
    {% endif %}
    {% if record.patient_replies_list %}
    {% for m in record.patient_replies_list %}
    <div class="mb-2"><span class="badge bg-secondary me-2">Patient</span>{{ m.time }} — {{ m.message }}</div>
    {% endfor %}
    {% endif %}
    {% if not record.doctor_replies_list and not record.patient_replies_list %}
    <div class="text-muted">No messages yet.</div>
    {% endif %}
  </div>
</div>

<form class="d-flex gap-2" method="post" action="{{ url_for('chat_reply_doctor') }}">
  <input type="hidden" name="timestamp" value="{{ record.timestamp }}">
  <input class="form-control" type="text" name="message" placeholder="Type a message..." required>
  <button class="btn btn-primary">Send</button>
</form>
{% endblock %}